<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Shape/Lines/Line.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Shape/Lines/Line.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * graph.line.shapes
 * @interface
 */
const DefaultLine = {

	/**
	 * @param  {} data
	 * @param  {} allNodesMap
	 * @param  {} line
	 */
	render(data, allNodesMap, line) {
		const { from, to, fromPoint = 0, toPoint = 0 } = data;
		const fromNode = allNodesMap[from];
		const toNode = allNodesMap[to];
		const fromPointNode = fromNode.linkPoints[fromPoint];
		const toPointNode = toNode.linkPoints[toPoint];
		let fromX = fromPointNode.x;
		let fromY = fromPointNode.y;
		let toX = toPointNode.x;
		let toY = toPointNode.y;
		const pathString = this.makePath(fromX, fromY, toX, toY, fromPointNode, toPointNode);
		const path = line ? line : this.paper.path();
		path.attr({
			d: pathString,
			strokeDasharray: "10",
			fill: "transparent",
			stroke: "rgba(178,190,205,0.7)"
		});
		path.animate(
			{
				strokeDasharray: "0"
			},
			300
		);
		return {
			path,
			data: {
				fromX,
				fromY,
				toX,
				toY
			}
		};
	},


	/**
	 * @param  {} fromX
	 * @param  {} fromY
	 * @param  {} toX
	 * @param  {} toY
	 * @param  {} fromPointNode
	 * @param  {} toPointNode
	 */
	makePath(fromX, fromY, toX, toY, fromPointNode, toPointNode) {
		let edgeX = fromX;
		let edgeY = fromY;
		let endX = toX;
		let endY = toY;
		if (fromPointNode.data.y === 1) {
			edgeY += 15;
		} else if (fromPointNode.data.y === 0) {
			edgeY -= 15;
		} else if (fromPointNode.data.x === 0) {
			edgeX -= 15;
		} else if (fromPointNode.data.x === 1) {
			edgeX += 15;
		}
		if (toPointNode.data.y === 1) {
			endY += 15;
			toY += 5;
		} else if (toPointNode.data.y === 0) {
			endY -= 15;
			toY -= 5;
		} else if (toPointNode.data.x === 0) {
			endX -= 15;
			toX -= 5;
		} else if (toPointNode.data.x === 1) {
			endX += 15;
			toX += 5;
		}
		let pathString = `M${fromX} ${fromY} T ${edgeX} ${edgeY}`;
		let bezierPoint1 = `${edgeX} ${edgeY +
			(fromPointNode.data.y === 1 ? 1 : -1) * Math.abs((edgeY - endY) / 2)}`;
		let bezierPoint2 = `${endX} ${endY +
			(toPointNode.data.y === 1 ? 1 : -1) * Math.abs((edgeY - endY) / 2)}`;
		let toPointString = `${endX} ${endY} T ${toX} ${toY} `;
		const path = `${pathString}C${bezierPoint1} ${bezierPoint2} ${toPointString}`;
		return path;
	},


	/**
	 * @param  {} data
	 * @param  {} allNodesMap
	 * @param  {} arrow
	 */
	renderArrow(data, allNodesMap, arrow) {
		const { to, toPoint = 0 } = data;
		const toNode = allNodesMap[to];
		const toPointNode = toNode.linkPoints[toPoint];
		const toLinkPoint = toNode.linkPointsTypes[toPoint];
		let angle = 0;
		if (toLinkPoint.y === 0) {
			angle = 180;
		} else if (toLinkPoint.x === 1) {
			angle = 90;
		} else if (toLinkPoint.x === 0) {
			angle = 270;
		}
		const toX = toPointNode.x;
		const toY = toPointNode.y;
		const pathString = `M${-5} ${10}L${0} ${0}L${5} ${10}Z`;
		const path = arrow ? arrow : this.paper.path();
		// 进行角度的中心变换
		const matrix = new window.Snap.Matrix();
		matrix.translate(toX, toY);
		matrix.rotate(angle, 0, 0);
		path.attr({
			class: "mm-line-arrow",
			d: pathString,
			fill: "rgba(178,190,205,0.7)",
			transform: matrix.toTransformString()
		});
		path.angle = angle;
		return path;
	},

	/**
	 * @param  {} data
	 */
	checkNewLine(data) {
		const { from, to } = data;
		if (from === to) {
			return false;
		}
		return true;
	}
};
export default DefaultLine</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Controller.html">Controller</a></li><li><a href="Event.html">Event</a></li><li><a href="Graph.html">Graph</a></li><li><a href="History.html">History</a></li><li><a href="Line.html">Line</a></li><li><a href="MMEditor.html">MMEditor</a></li><li><a href="Node.html">Node</a></li><li><a href="Schema.html">Schema</a></li></ul><h3>Interfaces</h3><ul><li><a href="DefaultLine.html">DefaultLine</a></li><li><a href="DefaultNode.html">DefaultNode</a></li><li><a href="IconNode.html">IconNode</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Nov 12 2019 15:23:14 GMT+0800 (GMT+08:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
